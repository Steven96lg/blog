---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import IndexCyberList from '../components/IndexCyberList.astro';
import { getCollection } from 'astro:content';

const ciberseguridadPosts = (await getCollection('ciberseguridad')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

// Obtener categor칤as 칰nicas de los posts
const uniqueCategories = Array.from(
  new Set(ciberseguridadPosts.map(post => post.data.tag))
).sort();

// Agregar "Todos" al inicio de las categor칤as
const categories = ['Todos', ...uniqueCategories];

// 칈conos disponibles para el timeline
const icons = [
  {
    name: 'shield',
    svg: '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="#00e699" d="M15 22h4c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2h-1v-2c0-1.1-.9-2-2-2h-3V9h1c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2h-4c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h1v2H8c-1.1 0-2 .9-2 2v2H5c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2h4c1.1 0 2-.9 2-2v-3c0-1.1-.9-2-2-2H8v-2h8v2h-1c-1.1 0-2 .9-2 2v3c0 1.1.9 2 2 2"/></svg>'
  },
  {
    name: 'lock',
    svg: '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 128 128"><path fill="#00e699" fill-rule="evenodd" d="M113.823 104.595c-1.795-1.478-3.629-2.921-5.308-4.525c-1.87-1.785-3.045-3.944-2.789-6.678c.147-1.573-.216-2.926-2.113-3.452c.446-1.154.864-1.928 1.033-2.753c.188-.92.178-1.887.204-2.834c.264-9.96-3.334-18.691-8.663-26.835c-2.454-3.748-5.017-7.429-7.633-11.066c-4.092-5.688-5.559-12.078-5.633-18.981a47.6 47.6 0 0 0-1.081-9.475C80.527 11.956 77.291 7.233 71.422 4.7c-4.497-1.942-9.152-2.327-13.901-1.084c-6.901 1.805-11.074 6.934-10.996 14.088c.074 6.885.417 13.779.922 20.648c.288 3.893-.312 7.252-2.895 10.34c-2.484 2.969-4.706 6.172-6.858 9.397c-1.229 1.844-2.317 3.853-3.077 5.931c-2.07 5.663-3.973 11.373-7.276 16.5c-1.224 1.9-1.363 4.026-.494 6.199c.225.563.363 1.429.089 1.882c-2.354 3.907-5.011 7.345-10.066 8.095c-3.976.591-4.172 1.314-4.051 5.413c.1 3.337.061 6.705-.28 10.021c-.363 3.555.008 4.521 3.442 5.373c7.924 1.968 15.913 3.647 23.492 6.854c3.227 1.365 6.465.891 9.064-1.763c2.713-2.771 6.141-3.855 9.844-3.859c6.285-.005 12.572.298 18.86.369c1.702.02 2.679.653 3.364 2.199c.84 1.893 2.26 3.284 4.445 3.526c4.193.462 8.013-.16 11.19-3.359c3.918-3.948 8.436-7.066 13.615-9.227c1.482-.619 2.878-1.592 4.103-2.648c2.231-1.922 2.113-3.146-.135-5M62.426 24.12c.758-2.601 2.537-4.289 5.243-4.801c2.276-.43 4.203.688 5.639 3.246c1.546 2.758 2.054 5.64.734 8.658c-1.083 2.474-1.591 2.707-4.123 1.868c-.474-.157-.937-.343-1.777-.652c.708-.594 1.154-1.035 1.664-1.382c1.134-.772 1.452-1.858 1.346-3.148c-.139-1.694-1.471-3.194-2.837-3.175c-1.225.017-2.262 1.167-2.4 2.915c-.086 1.089.095 2.199.173 3.589c-3.446-1.023-4.711-3.525-3.662-7.118m-12.75-2.251c1.274-1.928 3.197-2.314 5.101-1.024c2.029 1.376 3.547 5.256 2.763 7.576c-.285.844-1.127 1.5-1.716 2.241l-.604-.374c-.23-1.253-.276-2.585-.757-3.733c-.304-.728-1.257-1.184-1.919-1.762c-.622.739-1.693 1.443-1.757 2.228c-.088 1.084.477 2.28.969 3.331c.311.661 1.001 1.145 1.713 1.916l-1.922 1.51c-3.018-2.7-3.915-8.82-1.871-11.909M87.34 86.075c-.203 2.604-.5 2.713-3.118 3.098c-1.859.272-2.359.756-2.453 2.964a102 102 0 0 0-.012 7.753c.061 1.77-.537 3.158-1.755 4.393c-6.764 6.856-14.845 10.105-24.512 8.926c-4.17-.509-6.896-3.047-9.097-6.639c.98-.363 1.705-.607 2.412-.894c3.122-1.27 3.706-3.955 1.213-6.277c-1.884-1.757-3.986-3.283-6.007-4.892c-1.954-1.555-3.934-3.078-5.891-4.629c-1.668-1.323-2.305-3.028-2.345-5.188c-.094-5.182.972-10.03 3.138-14.747c1.932-4.209 3.429-8.617 5.239-12.885c.935-2.202 1.906-4.455 3.278-6.388c1.319-1.854 2.134-3.669 1.988-5.94c-.084-1.276-.016-2.562-.016-3.843l.707-.352c1.141.985 2.302 1.949 3.423 2.959c4.045 3.646 7.892 3.813 12.319.67c1.888-1.341 3.93-2.47 5.927-3.652c.497-.294 1.092-.423 1.934-.738c2.151 5.066 4.262 10.033 6.375 15c1.072 2.524 1.932 5.167 3.264 7.547c2.671 4.775 4.092 9.813 4.07 15.272c-.012 2.83.137 5.67-.081 8.482" clip-rule="evenodd"/></svg>'
  },
  {
    name: 'network',
    svg: '<svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" viewBox="0 0 24 24" fill="none" stroke="#00e699" stroke-width="2"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/><path d="M12 9v6m6-3h-6m-6 0H6"/></svg>'
  }
];

// Funci칩n para obtener el icono basado en el 칤ndice
const getIcon = (index: number) => icons[index % icons.length].svg;
---

<Layout>
	<Navigation />
	<main>
		<div class="general-content">
			<div class="ciberseguridad-header">
				<div class="title-content">
					<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24"><path fill="#00e699" d="M12 22q-3.475-.875-5.738-3.988T4 11.1V5l8-3l8 3v6.1q0 .25-.012.5t-.038.5q-.225-.05-.462-.075T19 12q-.275 0-.525.025t-.525.075q.025-.25.038-.487T18 11.1V6.375l-6-2.25l-6 2.25V11.1q0 3.025 1.7 5.5t4.3 3.3q.525-.175 1.025-.425T14 18.9v2.35q-.475.25-.975.438T12 22m4 0v-5h1v-1q0-.825.588-1.412T19 14t1.413.588T21 16v1h1v5zm2-5h2v-1q0-.425-.288-.712T19 15t-.712.288T18 16z"/></svg><h1> Cybersecurity Roadmap</h1>
				</div>
				<h2>Mi camino en Ciberseguridad.</h2>
				<p class="header-description">En esta secci칩n documento el camino que estoy siguiendo para formarme en ciberseguridad: desde los fundamentos de redes y Linux, hasta herramientas, conceptos de defensa y buenas pr치cticas del mundo real. Aqu칤 comparto lo que estudio, c칩mo lo aplico y las lecciones que voy aprendiendo en el proceso.</p>
			</div>

			<div class="main-cyber-content">
				<div class="index-content">
					<p class="title-index">Temas</p>
					<IndexCyberList categories={categories} />
				</div>
				<div class="ciberseguridad-posts">
					<div class="timeline">
						{ciberseguridadPosts.map((post, index) => (
							<div class={`timeline-item ${index === ciberseguridadPosts.length - 1 ? 'last-item' : ''}`} data-tag={post.data.tag}>
								<div class="timeline-marker" set:html={getIcon(index)}></div>
								<div class="timeline-content">
									<div class="timeline-date">
										{new Date(post.data.pubDate).toLocaleDateString('es-MX', { month: 'short', year: '2-digit' }).toUpperCase()}
									</div>
									<article class="post-card">
										<h2><a href={`/blog/ciberseguridad/${post.slug}`}>{post.data.title}</a></h2>
										<p>{post.data.description}</p>
										<div class="post-meta">
											<span class="tag">{post.data.tag}</span>
										</div>
									</article>
								</div>
							</div>
						))}
					</div>
				</div>
			</div>

			{ciberseguridadPosts.length === 0 && (
				<div class="no-posts">
					<p>Pronto habr치 contenido sobre ciberseguridad. 춰Mantente atento! 游</p>
				</div>
			)}
		</div>
	</main>
</Layout>

<style>
	main {
		width: 1250px;
		margin: 0 auto;
	}

	.general-content {
		padding-top: 100px;
		padding-bottom: 50px;
		font-family: "Archivo Narrow", sans-serif;
	}

	.main-cyber-content {
		display: grid;
		grid-template-columns: 30% 70%;
		& .index-content {
			& .title-index {
				color: #666666;
				font-size: 20px;
				font-weight: 100;
			}
		}
	}

	.ciberseguridad-header {
		padding: 40px 0;
		background: rgba(236, 245, 253, 0.4);
		background-color: transparent;
		color: #00e699;
		border-bottom: 1px solid #808080;
		margin-bottom: 40px;
		& h2{
			color: white;
			font-size: 40px;
			display: inline;
			font-weight: 100;
		}
		& .title-content {
			display: flex;
			align-items: center;
			gap: 6px;
			margin-bottom: 15px;
		}
	}

	.ciberseguridad-header h1 {
		color: #00e699
		margin: 0 0 15px 0;
		font-size: 20px;
		font-weight: 100;
	}

	.header-description {
		color: gray;
		font-family: Arial, Helvetica, sans-serif;
		font-size: 15px;
		line-height: 1.6;
		margin: 0;
	}

	.ciberseguridad-posts {
		position: relative;
		padding: 20px 0;
	}

	.timeline {
		position: relative;
		display: flex;
		flex-direction: column;
		gap: 40px;
	}

	.timeline::before {
		content: '';
		position: absolute;
		left: 26px;
		top: 55px;
		bottom: 0;
		width: 2px;
		background: linear-gradient(to bottom, #00e699, #00a86b);
	}

	.timeline-item:last-child ~ .timeline::before {
		bottom: 50px;
	}

	.timeline-item {
		position: relative;
		display: flex;
		gap: 30px;
		align-items: flex-start;
	}

	.timeline-item.last-item {
		margin-bottom: 20px;
	}

	.timeline-marker {
		position: relative;
		flex-shrink: 0;
		width: 50px;
		height: 50px;
		display: flex;
		align-items: center;
		justify-content: center;
		background: #1a1a1a;
		border: 3px solid #00e699;
		border-radius: 50%;
		z-index: 1;
		cursor: pointer;
		transition: all 0.3s ease;
	}

	.timeline-marker svg {
		width: 45px;
		height: 45px;
		stroke-linecap: round;
		stroke-linejoin: round;
	}

	.timeline-marker::after {
		content: '';
		position: absolute;
		width: 12px;
		height: 12px;
		background: #00e699;
		border-radius: 50%;
		opacity: 0;
	}

	.timeline-content {
		flex: 1;
		padding-top: 10px;
	}

	.timeline-date {
		color: #00e699;
		font-size: 12px;
		font-weight: 600;
		letter-spacing: 1px;
		margin-bottom: 15px;
		text-transform: uppercase;
	}

	.post-card {
		padding: 24px 24px 20px;
		border-radius: 8px;
		border: 1px solid rgba(255,255,255,0.1);
		box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
		transition: all 0.3s ease;
		background-color: rgba(65,65,65,0.1);
		font-family: Arial, Helvetica, sans-serif;
	}

	.post-card:hover {
		border-color: rgba(0, 230, 153, 0.3);
		box-shadow: 0 8px 25px rgba(0, 230, 153, 0.15);
		cursor: pointer;
	}

	.post-card h2 {
		margin: 0 0 12px 0;
		font-size: 20px;
		font-weight: 600;
	}

	.post-card h2 a {
		color: #e0e0e0;
		text-decoration: none;
		transition: color 0.3s ease;
	}

	.post-card h2 a:hover {
		color: #00e699;
	}

	.post-meta {
		display: flex;
		gap: 12px;
		align-items: center;
		margin-bottom: 15px;
		flex-wrap: wrap;
	}

	.post-meta .tag {
		background: rgba(105,105,105,0.1);
		color: white;
		padding: 8px 10px;
		border-radius: 3px;
		font-size: 11px;
		font-weight: 100;
	}

	.post-card p {
		color: #b0b0b0;
		line-height: 1.6;
		margin: 15px 0;
		font-size: 14px;
	}

	.no-posts {
		text-align: center;
		padding: 60px 20px;
		color: gray;
		font-size: 18px;
	}

	@media (max-width: 768px) {
		.main-cyber-content {
			grid-template-columns: 1fr;
		}

		.timeline::before {
			left: 30px;
		}

		.timeline-marker {
			width: 70px;
			height: 70px;
		}

		.timeline-item {
			gap: 20px;
		}

		.post-card {
			padding: 18px;
		}

		.post-card h2 {
			font-size: 18px;
		}
	}

	@media (max-width: 480px) {
		main {
			width: 100%;
			padding: 10px;
		}

		.general-content {
			padding-top: 60px;
			padding-bottom: 30px;
		}

		.ciberseguridad-header {
			padding: 20px 0;
		}

		.ciberseguridad-header h1 {
			font-size: 18px;
		}

		.ciberseguridad-header h2 {
			font-size: 28px;
		}

		.timeline::before {
			left: 20px;
		}

		.timeline-marker {
			width: 60px;
			height: 60px;
		}

		.timeline-content {
			padding-top: 5px;
		}

		.timeline-date {
			font-size: 10px;
		}

		.post-card {
			padding: 15px;
		}

		.post-card h2 {
			font-size: 16px;
		}

		.post-card p {
			font-size: 13px;
		}

		.timeline-item {
			gap: 15px;
		}
	}

	/* Animaciones para el filtrado de categor칤as */
	.timeline {
		transition: opacity 0.6s ease 0.3s;
	}

	.timeline.fade-out-timeline {
		opacity: 0;
	}

	.timeline.fade-in-timeline {
		opacity: 1;
	}

	.timeline::before {
		transition: opacity 0.6s ease;
	}

	.timeline.fade-out-timeline::before {
		opacity: 0;
	}

	.timeline.fade-in-timeline::before {
		opacity: 1;
	}

	.timeline-marker {
		transition: opacity 0.6s ease;
	}

	.timeline.fade-out-timeline .timeline-marker {
		opacity: 0;
	}

	.timeline.fade-in-timeline .timeline-marker {
		opacity: 1;
	}
</style>
